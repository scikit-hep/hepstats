

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Submodules &mdash; hepstats 0.2.1 documentation</title>








  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>


      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script type="text/javascript" src="../_static/js/theme.js"></script>




  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="hepstats" href="modules.html" />
</head>

<body class="wy-body-for-nav">


  <div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



            <a href="../index.html" class="icon icon-home"> hepstats



          </a>







<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">






              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick start</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">hepstats</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-hepstats.modeling">hepstats.modeling module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-hepstats.modeling.bayesian_blocks">Bayesian blocks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-hepstats.hypotests">hepstats.hypotests module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-hepstats.hypotests.parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-hepstats.hypotests.calculators">Calculators</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-hepstats.hypotests.core.discovery">Discovery test</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-hepstats.hypotests.core.upperlimit">Upper limit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-hepstats.hypotests.core.confidence_interval">Confidence interval</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-hepstats.hypotests.hypotests_object">Hypotests objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-hepstats.hypotests.hypotests_object">Toy utilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-hepstats.splot">hepstats.splot module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-hepstats.splot.sweights">sWeights</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>



        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


      <nav class="wy-nav-top" aria-label="top navigation">

          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hepstats</a>

      </nav>


      <div class="wy-nav-content">

        <div class="rst-content">

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">

      <li><a href="../index.html">Docs</a> &raquo;</li>

          <li><a href="modules.html">hepstats</a> &raquo;</li>

      <li>Submodules</li>


      <li class="wy-breadcrumbs-aside">


            <a href="../_sources/api/hepstats.rst.txt" rel="nofollow"> View page source</a>


      </li>

  </ul>


  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <div class="section" id="submodules">
<h1>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-hepstats.modeling">
<span id="hepstats-modeling-module"></span><h2>hepstats.modeling module<a class="headerlink" href="#module-hepstats.modeling" title="Permalink to this headline">¶</a></h2>
<p>Module for algorithms and methods used to model distributions.</p>
<p>This module contains in particular:</p>
<blockquote>
<div><ul class="simple">
<li><p>Bayesian Blocks binning algorithm.</p></li>
</ul>
</div></blockquote>
<div class="section" id="module-hepstats.modeling.bayesian_blocks">
<span id="bayesian-blocks"></span><h3>Bayesian blocks<a class="headerlink" href="#module-hepstats.modeling.bayesian_blocks" title="Permalink to this headline">¶</a></h3>
<div class="section" id="bayesian-block-implementation">
<h4>Bayesian Block implementation<a class="headerlink" href="#bayesian-block-implementation" title="Permalink to this headline">¶</a></h4>
<p>Dynamic programming algorithm for finding the optimal adaptive-width histogram.  Modified from the
bayesian blocks python implementation found in astroML <a class="bibtex reference internal" href="../index.html#vanderplas-2012" id="id1">[VCIG12]</a>.</p>
<ul class="simple">
<li><p>Based on Scargle et al 2012 <a class="bibtex reference internal" href="../index.html#scargle-2013" id="id2">[SNJC13]</a></p></li>
<li><p>Initial Python Implementation <a class="bibtex reference internal" href="../index.html#bb-jakevdp" id="id3">[BB_]</a></p></li>
<li><p>Initial Examination in HEP context <a class="bibtex reference internal" href="../index.html#pollack-2017srh" id="id4">[PBS17]</a></p></li>
</ul>
<dl class="class">
<dt id="hepstats.modeling.bayesian_blocks.Prior">
<em class="property">class </em><code class="sig-prename descclassname">hepstats.modeling.bayesian_blocks.</code><code class="sig-name descname">Prior</code><span class="sig-paren">(</span><em class="sig-param">p0=0.05</em>, <em class="sig-param">gamma=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/modeling/bayesian_blocks.html#Prior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.modeling.bayesian_blocks.Prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Helper class for calculating the prior on the fitness function.</p>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 44%" />
<col style="width: 56%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="hepstats.modeling.bayesian_blocks.Prior.calc">
<code class="sig-name descname">calc</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">N</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/modeling/bayesian_blocks.html#Prior.calc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.modeling.bayesian_blocks.Prior.calc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="hepstats.modeling.bayesian_blocks.bayesian_blocks">
<code class="sig-prename descclassname">hepstats.modeling.bayesian_blocks.</code><code class="sig-name descname">bayesian_blocks</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">weights=None</em>, <em class="sig-param">p0=0.05</em>, <em class="sig-param">gamma=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/modeling/bayesian_blocks.html#bayesian_blocks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.modeling.bayesian_blocks.bayesian_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Bayesian Blocks Implementation.</p>
<p>This is a flexible implementation of the Bayesian Blocks algorithm described in Scargle 2012
<a href="#id9"><span class="problematic" id="id5">[1]_</span></a>.  It has been modified to natively accept weighted events, for ease of use in HEP
applications.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>data</strong> (array): Input data values (one dimensional, length N). Repeat values are allowed.</p></li>
<li><p><strong>weights</strong> (array_like, optional): Weights for data (otherwise assume all data points have a weight of 1).
Must be same length as data. Defaults to None.</p></li>
<li><p><strong>p0</strong> (float, optional): False-positive rate, between 0 and 1.  A lower number places a stricter penalty
against creating more bin edges, thus reducing the potential for false-positive bin edges. In general,
the larger the number of bins, the small the p0 should be to prevent the creation of spurious, jagged
bins. Defaults to 0.05.</p></li>
<li><p><strong>gamma</strong> (float, optional): If specified, then use this gamma to compute the general prior form,
p ~ gamma^N. If gamma is specified, p0 is ignored. Defaults to None.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p><strong>edges</strong> (ndarray): Array containing the (N+1) bin edges</p></li>
</ul>
</dd>
<dt>Examples:</dt><dd><p>Unweighted data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="n">bayesian_blocks</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
<p>Unweighted data with repeats:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="mi">80</span><span class="p">:]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="n">bayesian_blocks</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
<p>Weighted data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="n">bayesian_blocks</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="module-hepstats.hypotests">
<span id="hepstats-hypotests-module"></span><h2>hepstats.hypotests module<a class="headerlink" href="#module-hepstats.hypotests" title="Permalink to this headline">¶</a></h2>
<p>Module for hypothesis tests, upper limits and confidence intervals calculations.</p>
<div class="section" id="module-hepstats.hypotests.parameters">
<span id="parameters"></span><h3>Parameters<a class="headerlink" href="#module-hepstats.hypotests.parameters" title="Permalink to this headline">¶</a></h3>
<p>Module defining the parameter of interest classes, currently includes:</p>
<ul class="simple">
<li><p><cite>POIarray</cite></p></li>
<li><p><cite>POI</cite></p></li>
</ul>
<dl class="class">
<dt id="hepstats.hypotests.parameters.POI">
<em class="property">class </em><code class="sig-prename descclassname">hepstats.hypotests.parameters.</code><code class="sig-name descname">POI</code><span class="sig-paren">(</span><em class="sig-param">parameter</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/parameters.html#POI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.parameters.POI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hepstats.hypotests.parameters.POIarray" title="hepstats.hypotests.parameters.POIarray"><code class="xref py py-class docutils literal notranslate"><span class="pre">hepstats.hypotests.parameters.POIarray</span></code></a></p>
<p>Class for single value parameter of interest:</p>
<blockquote>
<div><dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>parameter</strong>: the parameter of interest</p></li>
<li><p><strong>values</strong> (<cite>float</cite>, <cite>int</cite>): value of the parameter of interest</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Nsig</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;Nsig&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poi</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">Nsig</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndim</span></code></dt><dd><p>Returns the number of dimension of the <cite>POIarray</cite>.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">shape</span></code></dt><dd><p>Returns the shape of the <cite>POIarray</cite>.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.parameters.POI.value" title="hepstats.hypotests.parameters.POI.value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">value</span></code></a></dt><dd><p>Returns the value of the <cite>POI</cite>.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">values</span></code></dt><dd><p>Returns the values of the <cite>POIarray</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">append</span></code>(self, values)</p></td>
<td><p>Append values in the <cite>POIarray</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="hepstats.hypotests.parameters.POI.value">
<em class="property">property </em><code class="sig-name descname">value</code><a class="headerlink" href="#hepstats.hypotests.parameters.POI.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the <cite>POI</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="hepstats.hypotests.parameters.POIarray">
<em class="property">class </em><code class="sig-prename descclassname">hepstats.hypotests.parameters.</code><code class="sig-name descname">POIarray</code><span class="sig-paren">(</span><em class="sig-param">parameter</em>, <em class="sig-param">values</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/parameters.html#POIarray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.parameters.POIarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for parameters of interest with multiple values:</p>
<blockquote>
<div><dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>parameter</strong>: the parameter of interest</p></li>
<li><p><strong>values</strong> (<cite>list(float)</cite>,`numpy.array`): values of the parameter of interest</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Nsig</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;Nsig&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poi</span> <span class="o">=</span> <span class="n">POIarray</span><span class="p">(</span><span class="n">Nsig</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="#hepstats.hypotests.parameters.POIarray.ndim" title="hepstats.hypotests.parameters.POIarray.ndim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndim</span></code></a></dt><dd><p>Returns the number of dimension of the <cite>POIarray</cite>.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.parameters.POIarray.shape" title="hepstats.hypotests.parameters.POIarray.shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shape</span></code></a></dt><dd><p>Returns the shape of the <cite>POIarray</cite>.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.parameters.POIarray.values" title="hepstats.hypotests.parameters.POIarray.values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">values</span></code></a></dt><dd><p>Returns the values of the <cite>POIarray</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.parameters.POIarray.append" title="hepstats.hypotests.parameters.POIarray.append"><code class="xref py py-obj docutils literal notranslate"><span class="pre">append</span></code></a>(self, values)</p></td>
<td><p>Append values in the <cite>POIarray</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="hepstats.hypotests.parameters.POIarray.append">
<code class="sig-name descname">append</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">values</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/parameters.html#POIarray.append"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.parameters.POIarray.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Append values in the <cite>POIarray</cite>.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>values</strong> (<cite>list(float)</cite>,`numpy.array`): values to append</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.parameters.POIarray.ndim">
<em class="property">property </em><code class="sig-name descname">ndim</code><a class="headerlink" href="#hepstats.hypotests.parameters.POIarray.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of dimension of the <cite>POIarray</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.parameters.POIarray.shape">
<em class="property">property </em><code class="sig-name descname">shape</code><a class="headerlink" href="#hepstats.hypotests.parameters.POIarray.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the shape of the <cite>POIarray</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.parameters.POIarray.values">
<em class="property">property </em><code class="sig-name descname">values</code><a class="headerlink" href="#hepstats.hypotests.parameters.POIarray.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the values of the <cite>POIarray</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="hepstats.hypotests.parameters.asarray">
<code class="sig-prename descclassname">hepstats.hypotests.parameters.</code><code class="sig-name descname">asarray</code><span class="sig-paren">(</span><em class="sig-param">POI</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/parameters.html#asarray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.parameters.asarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a <cite>POI</cite> instance into a <cite>POIarray</cite> instance.</p>
</dd></dl>

</div>
<div class="section" id="module-hepstats.hypotests.calculators">
<span id="calculators"></span><h3>Calculators<a class="headerlink" href="#module-hepstats.hypotests.calculators" title="Permalink to this headline">¶</a></h3>
<p>Module defining the base class for the calculators for statistical tests based on the likelyhood ratio.</p>
<p>Any calculator can be a subclass of <cite>BaseCalculator</cite>. Currently implemented:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>AsymptoticCalculator</cite>: calculator using the asymptotic formulae of the likehood ratio.</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Acronyms used in the code:</dt><dd><ul class="simple">
<li><p>nll = negative log-likehood, the likehood being the <cite>loss</cite> attribute of a calculator;</p></li>
<li><p>obs = observed, i.e. measured on provided data.</p></li>
</ul>
</dd>
</dl>
<span class="target" id="module-hepstats.hypotests.calculators.basecalculator"></span><dl class="class">
<dt id="hepstats.hypotests.calculators.basecalculator.BaseCalculator">
<em class="property">class </em><code class="sig-prename descclassname">hepstats.hypotests.calculators.basecalculator.</code><code class="sig-name descname">BaseCalculator</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">minimizer</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/basecalculator.html#BaseCalculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject" title="hepstats.hypotests.hypotests_object.HypotestsObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">hepstats.hypotests.hypotests_object.HypotestsObject</span></code></a></p>
<p>Base class for calculator.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>input</strong> : loss or fit result</p></li>
<li><p><strong>minimizer</strong> : minimizer to use to find the minimum of the loss function</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">zfit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zfit.core.loss</span> <span class="kn">import</span> <span class="n">UnbinnedNLL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zfit.minimize</span> <span class="kn">import</span> <span class="n">Minuit</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Space</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">UnbinnedNLL</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">BaseCalculator</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">minimizer</span><span class="o">=</span><span class="n">Minuit</span><span class="p">())</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">bestfit</span></code></dt><dd><p>Returns the best fit values of the model parameters.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">constraints</span></code></dt><dd><p>Returns the constraints on the loss / likehood function.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></dt><dd><p>Returns the data.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">loss</span></code></dt><dd><p>Returns the loss / likelihood function.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimizer</span></code></dt><dd><p>Returns the minimizer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></dt><dd><p>Returns the model.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.check_pois" title="hepstats.hypotests.calculators.basecalculator.BaseCalculator.check_pois"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_pois</span></code></a>(pois)</p></td>
<td><p>Checks if the parameters of interest are all <cite>hepstats.parameters.POI/POIarray</cite> instances.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.check_pois_compatibility" title="hepstats.hypotests.calculators.basecalculator.BaseCalculator.check_pois_compatibility"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_pois_compatibility</span></code></a>(poi1, poi2)</p></td>
<td><p>Checks compatibility between two lists of <cite>hepstats.parameters.POIarray</cite> instances.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.expected_poi" title="hepstats.hypotests.calculators.basecalculator.BaseCalculator.expected_poi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expected_poi</span></code></a>(self, poinull, poialt, nsigma)</p></td>
<td><p>Computes the expected parameter of interest values such that the expected p_values = <span class="math notranslate nohighlight">\(lpha\)</span> for different values of <span class="math notranslate nohighlight">\(\sigma\)</span> (0=expected/median)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.expected_pvalue" title="hepstats.hypotests.calculators.basecalculator.BaseCalculator.expected_pvalue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expected_pvalue</span></code></a>(self, poinull, poialt, nsigma)</p></td>
<td><p>Computes the expected pvalues and error bands for different values of <span class="math notranslate nohighlight">\(\sigma\)</span> (0=expected/median)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code>(self, name)</p></td>
<td><p>Returns the parameter in loss function with given input name.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">lossbuilder</span></code>(self, model, data[, weights])</p></td>
<td><p>Method to build a new loss function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.obs_nll" title="hepstats.hypotests.calculators.basecalculator.BaseCalculator.obs_nll"><code class="xref py py-obj docutils literal notranslate"><span class="pre">obs_nll</span></code></a>(self, pois)</p></td>
<td><p>Compute observed negative log-likelihood values for given parameters of interest.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.pvalue" title="hepstats.hypotests.calculators.basecalculator.BaseCalculator.pvalue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pvalue</span></code></a>(self, poinull, poialt, NoneType] = None)</p></td>
<td><p>Computes pvalues for the null and alternative hypothesis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.q" title="hepstats.hypotests.calculators.basecalculator.BaseCalculator.q"><code class="xref py py-obj docutils literal notranslate"><span class="pre">q</span></code></a>(self, nll1, nll2, poi1, poi2[, onesided, …])</p></td>
<td><p>Compute values of the test statistic q defined as the difference between negative log-likelihood values <span class="math notranslate nohighlight">\(q = nll1 - nll2\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.qobs" title="hepstats.hypotests.calculators.basecalculator.BaseCalculator.qobs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">qobs</span></code></a>(self, poinull[, onesided, …])</p></td>
<td><p>Computes observed values of the <span class="math notranslate nohighlight">\(\Delta\)</span> log-likelihood test statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params_to_bestfit</span></code>(self)</p></td>
<td><p>Set the values of the parameters in the models to the best fit values</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="hepstats.hypotests.calculators.basecalculator.BaseCalculator.check_pois">
<em class="property">static </em><code class="sig-name descname">check_pois</code><span class="sig-paren">(</span><em class="sig-param">pois</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/basecalculator.html#BaseCalculator.check_pois"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.check_pois" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the parameters of interest are all <cite>hepstats.parameters.POI/POIarray</cite> instances.</p>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.basecalculator.BaseCalculator.check_pois_compatibility">
<em class="property">static </em><code class="sig-name descname">check_pois_compatibility</code><span class="sig-paren">(</span><em class="sig-param">poi1</em>, <em class="sig-param">poi2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/basecalculator.html#BaseCalculator.check_pois_compatibility"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.check_pois_compatibility" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks compatibility between two lists of <cite>hepstats.parameters.POIarray</cite> instances.</p>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.basecalculator.BaseCalculator.expected_poi">
<code class="sig-name descname">expected_poi</code><span class="sig-paren">(</span><em class="sig-param">self, poinull: List[hepstats.hypotests.parameters.POI], poialt: List[hepstats.hypotests.parameters.POI], nsigma, alpha=0.05, CLs=False, qtilde=False, onesided=True, onesideddiscovery=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/basecalculator.html#BaseCalculator.expected_poi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.expected_poi" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the expected parameter of interest values such that the expected p_values = <span class="math notranslate nohighlight">\(lpha\)</span> for
different values of <span class="math notranslate nohighlight">\(\sigma\)</span> (0=expected/median)</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>poinull</strong> (List[<cite>hypotests.POI</cite>]): parameters of interest for the null hypothesis</p></li>
<li><p><strong>poialt</strong> (List[<cite>hypotests.POI</cite>], optional): parameters of interest for the alternative hypothesis</p></li>
<li><p><strong>nsigma</strong> (<cite>numpy.array</cite>): array of values of <span class="math notranslate nohighlight">\(\sigma\)</span> to compute the expected pvalue</p></li>
<li><p><strong>alpha</strong> (float, default=0.05): significance level</p></li>
<li><p><strong>CLs</strong> (bool, optional): if <cite>True</cite> uses pvalues as <span class="math notranslate nohighlight">\(p_{cls}=p_{null}/p_{alt}=p_{clsb}/p_{clb}\)</span>
else as <span class="math notranslate nohighlight">\(p_{clsb} = p_{null}\)</span></p></li>
<li><p><strong>qtilde</strong> (bool, optional): if <cite>True</cite> use the <span class="math notranslate nohighlight">\(\widetilde{q}\)</span> test statistics else (default)
use the <span class="math notranslate nohighlight">\(q\)</span> test statistic</p></li>
<li><p><strong>onesided</strong> (bool, optional): if <cite>True</cite> (default) computes onesided pvalues</p></li>
<li><p><strong>onesideddiscovery</strong> (bool, optional): if <cite>True</cite> (default) computes onesided pvalues for a discovery</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p><cite>numpy.array</cite>: array of expected POI values for each :math:<a href="#id6"><span class="problematic" id="id7">`</span></a>sigma  value</p>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poinull</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poialt</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nll</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">expected_poi</span><span class="p">(</span><span class="n">poinull</span><span class="p">,</span> <span class="n">poialt</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.basecalculator.BaseCalculator.expected_pvalue">
<code class="sig-name descname">expected_pvalue</code><span class="sig-paren">(</span><em class="sig-param">self, poinull: List[hepstats.hypotests.parameters.POI], poialt: List[hepstats.hypotests.parameters.POI], nsigma, CLs=False, qtilde=False, onesided=True, onesideddiscovery=False</em><span class="sig-paren">)</span> &#x2192; Dict[int, &lt;built-in function array&gt;]<a class="reference internal" href="../_modules/hepstats/hypotests/calculators/basecalculator.html#BaseCalculator.expected_pvalue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.expected_pvalue" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the expected pvalues and error bands for different values of <span class="math notranslate nohighlight">\(\sigma\)</span> (0=expected/median)</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>poinull</strong> (List[<cite>hypotests.POI</cite>]): parameters of interest for the null hypothesis</p></li>
<li><p><strong>poialt</strong> (List[<cite>hypotests.POI</cite>], optional): parameters of interest for the alternative hypothesis</p></li>
<li><p><strong>nsigma</strong> (<cite>numpy.array</cite>): array of values of <span class="math notranslate nohighlight">\(\sigma\)</span> to compute the expected pvalue</p></li>
<li><p><strong>CLs</strong> (bool, optional): if <cite>True</cite> computes pvalues as <span class="math notranslate nohighlight">\(p_{cls}=p_{null}/p_{alt}=p_{clsb}/p_{clb}\)</span>
else as <span class="math notranslate nohighlight">\(p_{clsb} = p_{null}\)</span></p></li>
<li><p><strong>qtilde</strong> (bool, optional): if <cite>True</cite> use the <span class="math notranslate nohighlight">\(\widetilde{q}\)</span> test statistics else (default)
use the <span class="math notranslate nohighlight">\(q\)</span> test statistic</p></li>
<li><p><strong>onesided</strong> (bool, optional): if <cite>True</cite> (default) computes onesided pvalues</p></li>
<li><p><strong>onesideddiscovery</strong> (bool, optional): if <cite>True</cite> (default) computes onesided pvalues for a discovery</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p><cite>numpy.array</cite>: array of expected pvalues for each <span class="math notranslate nohighlight">\(\sigma\)</span> value</p>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poinull</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poialt</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nll</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">expected_pvalue</span><span class="p">(</span><span class="n">poinull</span><span class="p">,</span> <span class="n">poialt</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.basecalculator.BaseCalculator.obs_nll">
<code class="sig-name descname">obs_nll</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">pois</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/hepstats/hypotests/calculators/basecalculator.html#BaseCalculator.obs_nll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.obs_nll" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute observed negative log-likelihood values for given parameters of interest.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>pois</strong> (List[<cite>hypotests.POI</cite>]): parameters of interest</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p><cite>numpy.array</cite>: observed nll values</p>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poi</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nll</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">obs_nll</span><span class="p">(</span><span class="n">poi</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.basecalculator.BaseCalculator.pvalue">
<code class="sig-name descname">pvalue</code><span class="sig-paren">(</span><em class="sig-param">self, poinull: List[hepstats.hypotests.parameters.POI], poialt: Union[List[hepstats.hypotests.parameters.POI], NoneType] = None, qtilde=False, onesided=True, onesideddiscovery=False</em><span class="sig-paren">)</span> &#x2192; Tuple[numpy.ndarray, numpy.ndarray]<a class="reference internal" href="../_modules/hepstats/hypotests/calculators/basecalculator.html#BaseCalculator.pvalue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.pvalue" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes pvalues for the null and alternative hypothesis.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>poinull</strong> (List[<cite>hypotests.POI</cite>]): parameters of interest for the null hypothesis</p></li>
<li><p><strong>poialt</strong> (List[<cite>hypotests.POI</cite>], optional): parameters of interest for the alternative hypothesis</p></li>
<li><p><strong>qtilde</strong> (bool, optional): if <cite>True</cite> use the <span class="math notranslate nohighlight">\(\widetilde{q}\)</span> test statistics else (default)
use the <span class="math notranslate nohighlight">\(q\)</span> test statistic</p></li>
<li><p><strong>onesided</strong> (bool, optional): if <cite>True</cite> (default) computes onesided pvalues</p></li>
<li><p><strong>onesideddiscovery</strong> (bool, optional): if <cite>True</cite> (default) computes onesided pvalues for a discovery test</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>Tuple(<cite>numpy.array</cite>, <cite>numpy.array</cite>): pnull, palt</p>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poinull</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poialt</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pvalues</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">pavalue</span><span class="p">(</span><span class="n">poinull</span><span class="p">,</span> <span class="n">poialt</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.basecalculator.BaseCalculator.q">
<code class="sig-name descname">q</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">nll1: &lt;built-in function array&gt;</em>, <em class="sig-param">nll2: &lt;built-in function array&gt;</em>, <em class="sig-param">poi1</em>, <em class="sig-param">poi2</em>, <em class="sig-param">onesided=True</em>, <em class="sig-param">onesideddiscovery=False</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/hepstats/hypotests/calculators/basecalculator.html#BaseCalculator.q"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.q" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute values of the test statistic q defined as the difference between negative log-likelihood
values <span class="math notranslate nohighlight">\(q = nll1 - nll2\)</span>.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>nll1</strong> (<cite>numpy.array</cite>): array of nll values #1, evaluated with poi1</p></li>
<li><p><strong>nll2</strong> (<cite>numpy.array</cite>): array of nll values #2, evaluated with poi2</p></li>
<li><p><strong>poi1</strong> ((List[<cite>hypotests.POI</cite>])): list of POI’s #1</p></li>
<li><p><strong>poi2</strong> ((List[<cite>hypotests.POI</cite>])): list of POI’s #2</p></li>
<li><p><strong>onesided</strong> (bool, optional, default=True)</p></li>
<li><p><strong>onesideddiscovery</strong> (bool, optional, default=True)</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p><cite>numpy.array</cite>: array of <span class="math notranslate nohighlight">\(q\)</span> values</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.basecalculator.BaseCalculator.qobs">
<code class="sig-name descname">qobs</code><span class="sig-paren">(</span><em class="sig-param">self, poinull: List[hepstats.hypotests.parameters.POI], onesided=True, onesideddiscovery=False, qtilde=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/basecalculator.html#BaseCalculator.qobs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator.qobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes observed values of the <span class="math notranslate nohighlight">\(\Delta\)</span> log-likelihood test statistic.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>poinull</strong> (List[<cite>hypotests.POI</cite>]): parameters of interest for the null hypothesis</p></li>
<li><p><strong>qtilde</strong> (bool, optional): if <cite>True</cite> use the <span class="math notranslate nohighlight">\(\tilde{q}\)</span> test statistics else (default)
use the <span class="math notranslate nohighlight">\(q\)</span> test statistic</p></li>
<li><p><strong>onesided</strong> (bool, optional): if <cite>True</cite> (default) computes onesided pvalues</p></li>
<li><p><strong>onesideddiscovery</strong> (bool, optional): if <cite>True</cite> (default) computes onesided pvalues for a
discovery test</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p><cite>numpy.array</cite>: observed values of q</p>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poi</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">qobs</span><span class="p">(</span><span class="n">poi</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="hepstats.hypotests.calculators.basecalculator.BaseToysCalculator">
<em class="property">class </em><code class="sig-prename descclassname">hepstats.hypotests.calculators.basecalculator.</code><code class="sig-name descname">BaseToysCalculator</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">minimizer</em>, <em class="sig-param">sampler</em>, <em class="sig-param">sample</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/basecalculator.html#BaseToysCalculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.BaseToysCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator" title="hepstats.hypotests.calculators.basecalculator.BaseCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">hepstats.hypotests.calculators.basecalculator.BaseCalculator</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">bestfit</span></code></dt><dd><p>Returns the best fit values of the model parameters.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">constraints</span></code></dt><dd><p>Returns the constraints on the loss / likehood function.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></dt><dd><p>Returns the data.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">loss</span></code></dt><dd><p>Returns the loss / likelihood function.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimizer</span></code></dt><dd><p>Returns the minimizer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></dt><dd><p>Returns the model.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_pois</span></code>(pois)</p></td>
<td><p>Checks if the parameters of interest are all <cite>hepstats.parameters.POI/POIarray</cite> instances.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_pois_compatibility</span></code>(poi1, poi2)</p></td>
<td><p>Checks compatibility between two lists of <cite>hepstats.parameters.POIarray</cite> instances.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">expected_poi</span></code>(self, poinull, poialt, nsigma)</p></td>
<td><p>Computes the expected parameter of interest values such that the expected p_values = <span class="math notranslate nohighlight">\(lpha\)</span> for different values of <span class="math notranslate nohighlight">\(\sigma\)</span> (0=expected/median)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">expected_pvalue</span></code>(self, poinull, poialt, nsigma)</p></td>
<td><p>Computes the expected pvalues and error bands for different values of <span class="math notranslate nohighlight">\(\sigma\)</span> (0=expected/median)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code>(self, name)</p></td>
<td><p>Returns the parameter in loss function with given input name.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">lossbuilder</span></code>(self, model, data[, weights])</p></td>
<td><p>Method to build a new loss function.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">obs_nll</span></code>(self, pois)</p></td>
<td><p>Compute observed negative log-likelihood values for given parameters of interest.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pvalue</span></code>(self, poinull, poialt, NoneType] = None)</p></td>
<td><p>Computes pvalues for the null and alternative hypothesis.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">q</span></code>(self, nll1, nll2, poi1, poi2[, onesided, …])</p></td>
<td><p>Compute values of the test statistic q defined as the difference between negative log-likelihood values <span class="math notranslate nohighlight">\(q = nll1 - nll2\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">qobs</span></code>(self, poinull[, onesided, …])</p></td>
<td><p>Computes observed values of the <span class="math notranslate nohighlight">\(\Delta\)</span> log-likelihood test statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params_to_bestfit</span></code>(self)</p></td>
<td><p>Set the values of the parameters in the models to the best fit values</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="hepstats.hypotests.calculators.basecalculator.ToysCalculator">
<em class="property">class </em><code class="sig-prename descclassname">hepstats.hypotests.calculators.basecalculator.</code><code class="sig-name descname">ToysCalculator</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">minimizer</em>, <em class="sig-param">ntoysnull=100</em>, <em class="sig-param">ntoysalt=100</em>, <em class="sig-param">sampler=&lt;function base_sampler&gt;</em>, <em class="sig-param">sample=&lt;function base_sample&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/basecalculator.html#ToysCalculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.ToysCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.BaseToysCalculator" title="hepstats.hypotests.calculators.basecalculator.BaseToysCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">hepstats.hypotests.calculators.basecalculator.BaseToysCalculator</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">hepstats.hypotests.toyutils.ToysManager</span></code></p>
<p>Class for calculators using toys.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">bestfit</span></code></dt><dd><p>Returns the best fit values of the model parameters.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">constraints</span></code></dt><dd><p>Returns the constraints on the loss / likehood function.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></dt><dd><p>Returns the data.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">loss</span></code></dt><dd><p>Returns the loss / likelihood function.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimizer</span></code></dt><dd><p>Returns the minimizer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></dt><dd><p>Returns the model.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.ToysCalculator.ntoysalt" title="hepstats.hypotests.calculators.basecalculator.ToysCalculator.ntoysalt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ntoysalt</span></code></a></dt><dd><p>Returns the number of toys generated for the alternative hypothesis.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.ToysCalculator.ntoysnull" title="hepstats.hypotests.calculators.basecalculator.ToysCalculator.ntoysnull"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ntoysnull</span></code></a></dt><dd><p>Returns the number of toys generated for the null hypothesis.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_toyresult</span></code>(self, toy)</p></td>
<td><p>Add ToyResult to the manager.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_pois</span></code>(pois)</p></td>
<td><p>Checks if the parameters of interest are all <cite>hepstats.parameters.POI/POIarray</cite> instances.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_pois_compatibility</span></code>(poi1, poi2)</p></td>
<td><p>Checks compatibility between two lists of <cite>hepstats.parameters.POIarray</cite> instances.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">expected_poi</span></code>(self, poinull, poialt, nsigma)</p></td>
<td><p>Computes the expected parameter of interest values such that the expected p_values = <span class="math notranslate nohighlight">\(lpha\)</span> for different values of <span class="math notranslate nohighlight">\(\sigma\)</span> (0=expected/median)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">expected_pvalue</span></code>(self, poinull, poialt, nsigma)</p></td>
<td><p>Computes the expected pvalues and error bands for different values of <span class="math notranslate nohighlight">\(\sigma\)</span> (0=expected/median)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.ToysCalculator.from_yaml" title="hepstats.hypotests.calculators.basecalculator.ToysCalculator.from_yaml"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_yaml</span></code></a>(filename, loss, minimizer[, …])</p></td>
<td><p>ToysCalculator constructor with the toys loaded from a yaml file.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_and_fit_toys</span></code>(self, ntoys, poigen, …)</p></td>
<td><p>Generate and fit toys for at a given POI (poigen).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code>(self, name)</p></td>
<td><p>Returns the parameter in loss function with given input name.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_toyresult</span></code>(self, poigen, poieval)</p></td>
<td><p>Getter function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.ToysCalculator.get_toys_alt" title="hepstats.hypotests.calculators.basecalculator.ToysCalculator.get_toys_alt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_toys_alt</span></code></a>(self, poigen, poieval[, qtilde])</p></td>
<td><p>Return the generated toys for the alternative hypothesis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.ToysCalculator.get_toys_null" title="hepstats.hypotests.calculators.basecalculator.ToysCalculator.get_toys_null"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_toys_null</span></code></a>(self, poigen, poieval[, qtilde])</p></td>
<td><p>Return the generated toys for the null hypothesis.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">keys</span></code>(self)</p></td>
<td><p>Returns keys of the <cite>ToysManager</cite> instance defined as <cite>key = (toy.poigen, toy.poieval)</cite> for a given <cite>ToyResult</cite> instance <cite>toy</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">lossbuilder</span></code>(self, model, data[, weights])</p></td>
<td><p>Method to build a new loss function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ntoys</span></code>(self, poigen, poieval)</p></td>
<td><p>Return the number of toys generated from given value of a POI, and scanned/evaluated for given values_equal of the same POI.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">obs_nll</span></code>(self, pois)</p></td>
<td><p>Compute observed negative log-likelihood values for given parameters of interest.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pvalue</span></code>(self, poinull, poialt, NoneType] = None)</p></td>
<td><p>Computes pvalues for the null and alternative hypothesis.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">q</span></code>(self, nll1, nll2, poi1, poi2[, onesided, …])</p></td>
<td><p>Compute values of the test statistic q defined as the difference between negative log-likelihood values <span class="math notranslate nohighlight">\(q = nll1 - nll2\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">qobs</span></code>(self, poinull[, onesided, …])</p></td>
<td><p>Computes observed values of the <span class="math notranslate nohighlight">\(\Delta\)</span> log-likelihood test statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample</span></code>(self, sampler, ntoys[, poi])</p></td>
<td><p>Returns the samples generated from the sampler for a given value of a parameter of interest</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sampler</span></code>(self[, floating_params])</p></td>
<td><p>Create sampler with models.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params_to_bestfit</span></code>(self)</p></td>
<td><p>Set the values of the parameters in the models to the best fit values</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_yaml</span></code>(self, filename)</p></td>
<td><p>Save the toys into a yaml file under the key <cite>toys</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">toyresults_to_dict</span></code>(self)</p></td>
<td><p>Returns a list of all the toy results converted into dictionnaries</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">toys_loss</span></code>(self, parameter_name)</p></td>
<td><p>Construct a loss function constructed with a sampler for a given floating parameter</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">toysresults_from_yaml</span></code>(self, filename)</p></td>
<td><p>Extract toy results from a yaml file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">values</span></code>(self)</p></td>
<td><p>Returns values of <cite>ToysManager</cite> instance that are <cite>ToyResult</cite> instances.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="hepstats.hypotests.calculators.basecalculator.ToysCalculator.from_yaml">
<em class="property">classmethod </em><code class="sig-name descname">from_yaml</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">loss</em>, <em class="sig-param">minimizer</em>, <em class="sig-param">ntoysnull=100</em>, <em class="sig-param">ntoysalt=100</em>, <em class="sig-param">sampler=&lt;function base_sampler at 0x129062560&gt;</em>, <em class="sig-param">sample=&lt;function base_sample at 0x1290628c0&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/basecalculator.html#ToysCalculator.from_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.ToysCalculator.from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>ToysCalculator constructor with the toys loaded from a yaml file.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>filename</strong> (str)</p></li>
<li><p><strong>input</strong> : loss or fit result</p></li>
<li><p><strong>minimizer</strong> : minimizer to use to find the minimum of the loss function</p></li>
<li><p><strong>ntoysnull</strong> (int, default=100): minimum number of toys to generate for the null hypothesis</p></li>
<li><p><strong>ntoysalt</strong> (int, default=100): minimum number of toys to generate for the alternative hypothesis</p></li>
<li><p><strong>sampler</strong> : function used to create sampler with models, number of events and floating parameters in the sample Default is <cite>hepstats.fitutils.sampling.base_sampler</cite>.</p></li>
<li><p><strong>sample</strong> : function used to get samples from the sampler. Default is <cite>hepstats.fitutils.sampling.base_sample</cite>.</p></li>
</ul>
</dd>
<dt>Returns</dt><dd><p>ToysCalculator</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.basecalculator.ToysCalculator.get_toys_alt">
<code class="sig-name descname">get_toys_alt</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">poigen</em>, <em class="sig-param">poieval</em>, <em class="sig-param">qtilde=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/basecalculator.html#ToysCalculator.get_toys_alt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.ToysCalculator.get_toys_alt" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the generated toys for the alternative hypothesis.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>poigen</strong> (POI): POI used to generate the toys</p></li>
<li><p><strong>ntoys</strong> (int): number of toys to generate</p></li>
<li><p><strong>poieval</strong> (POIarray): POI values to evaluate the loss function</p></li>
<li><p><strong>qtilde</strong> (bool, optional): if <cite>True</cite> use the :math:`    ilde{q}` test statistics else (default) use the <span class="math notranslate nohighlight">\(q\)</span> test statistic</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poinull</span> <span class="o">=</span> <span class="n">POIarray</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poialt</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">get_toys_alt</span><span class="p">(</span><span class="n">poialt</span><span class="p">,</span> <span class="n">poieval</span><span class="o">=</span><span class="n">poinull</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.basecalculator.ToysCalculator.get_toys_null">
<code class="sig-name descname">get_toys_null</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">poigen</em>, <em class="sig-param">poieval</em>, <em class="sig-param">qtilde=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/basecalculator.html#ToysCalculator.get_toys_null"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.ToysCalculator.get_toys_null" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the generated toys for the null hypothesis.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>poigen</strong> (POI): POI used to generate the toys</p></li>
<li><p><strong>ntoys</strong> (int): number of toys to generate</p></li>
<li><p><strong>poieval</strong> (POIarray): POI values to evaluate the loss function</p></li>
<li><p><strong>qtilde</strong> (bool, optional): if <cite>True</cite> use the :math:`    ilde{q}` test statistics else (default) use the <span class="math notranslate nohighlight">\(q\)</span> test statistic</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poinull</span> <span class="o">=</span> <span class="n">POIarray</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poialt</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">poinull</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">calc</span><span class="o">.</span><span class="n">get_toys_alt</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">poieval</span><span class="o">=</span><span class="n">poialt</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.basecalculator.ToysCalculator.ntoysalt">
<em class="property">property </em><code class="sig-name descname">ntoysalt</code><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.ToysCalculator.ntoysalt" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of toys generated for the alternative hypothesis.</p>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.basecalculator.ToysCalculator.ntoysnull">
<em class="property">property </em><code class="sig-name descname">ntoysnull</code><a class="headerlink" href="#hepstats.hypotests.calculators.basecalculator.ToysCalculator.ntoysnull" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of toys generated for the null hypothesis.</p>
</dd></dl>

</dd></dl>

<div class="section" id="module-hepstats.hypotests.calculators.asymptotic_calculator">
<span id="asymptotic"></span><h4>Asymptotic<a class="headerlink" href="#module-hepstats.hypotests.calculators.asymptotic_calculator" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator">
<em class="property">class </em><code class="sig-prename descclassname">hepstats.hypotests.calculators.asymptotic_calculator.</code><code class="sig-name descname">AsymptoticCalculator</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">minimizer</em>, <em class="sig-param">asimov_bins=100</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/asymptotic_calculator.html#AsymptoticCalculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.BaseCalculator" title="hepstats.hypotests.calculators.basecalculator.BaseCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">hepstats.hypotests.calculators.basecalculator.BaseCalculator</span></code></a></p>
<p>Class for asymptotic calculators. Can be used only with one parameter
of interest.</p>
<p>See G. Cowan, K. Cranmer, E. Gross and O. Vitells: Asymptotic formulae for
likelihood- based tests of new physics. Eur. Phys. J., C71:1–19, 2011</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">bestfit</span></code></dt><dd><p>Returns the best fit values of the model parameters.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">constraints</span></code></dt><dd><p>Returns the constraints on the loss / likehood function.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></dt><dd><p>Returns the data.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">loss</span></code></dt><dd><p>Returns the loss / likelihood function.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimizer</span></code></dt><dd><p>Returns the minimizer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></dt><dd><p>Returns the model.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.asimov_dataset" title="hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.asimov_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">asimov_dataset</span></code></a>(self, poi)</p></td>
<td><p>Gets the Asimov dataset for a given alternative hypothesis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.asimov_loss" title="hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.asimov_loss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">asimov_loss</span></code></a>(self, poi)</p></td>
<td><p>Constructs a loss function using the Asimov dataset for a given alternative hypothesis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.asimov_nll" title="hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.asimov_nll"><code class="xref py py-obj docutils literal notranslate"><span class="pre">asimov_nll</span></code></a>(self, pois, poialt)</p></td>
<td><p>Computes negative log-likelihood values for given parameters of interest using the Asimov dataset generated with a given alternative hypothesis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.check_pois" title="hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.check_pois"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_pois</span></code></a>(pois)</p></td>
<td><p>Checks if the parameters of interest are all <cite>hepstats.parameters.POI/POIarray</cite> instances.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_pois_compatibility</span></code>(poi1, poi2)</p></td>
<td><p>Checks compatibility between two lists of <cite>hepstats.parameters.POIarray</cite> instances.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">expected_poi</span></code>(self, poinull, poialt, nsigma)</p></td>
<td><p>Computes the expected parameter of interest values such that the expected p_values = <span class="math notranslate nohighlight">\(lpha\)</span> for different values of <span class="math notranslate nohighlight">\(\sigma\)</span> (0=expected/median)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">expected_pvalue</span></code>(self, poinull, poialt, nsigma)</p></td>
<td><p>Computes the expected pvalues and error bands for different values of <span class="math notranslate nohighlight">\(\sigma\)</span> (0=expected/median)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code>(self, name)</p></td>
<td><p>Returns the parameter in loss function with given input name.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">lossbuilder</span></code>(self, model, data[, weights])</p></td>
<td><p>Method to build a new loss function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">obs_nll</span></code>(self, pois)</p></td>
<td><p>Compute observed negative log-likelihood values for given parameters of interest.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.palt" title="hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.palt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">palt</span></code></a>(self, qobs, qalt[, onesided, …])</p></td>
<td><p>Computes the pvalue for the alternative hypothesis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.pnull" title="hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.pnull"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pnull</span></code></a>(self, qobs[, qalt, onesided, …])</p></td>
<td><p>Computes the pvalue for the null hypothesis.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pvalue</span></code>(self, poinull, poialt, NoneType] = None)</p></td>
<td><p>Computes pvalues for the null and alternative hypothesis.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">q</span></code>(self, nll1, nll2, poi1, poi2[, onesided, …])</p></td>
<td><p>Compute values of the test statistic q defined as the difference between negative log-likelihood values <span class="math notranslate nohighlight">\(q = nll1 - nll2\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.qalt" title="hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.qalt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">qalt</span></code></a>(self, poinull, poialt, onesided, …)</p></td>
<td><p>Computes alternative hypothesis values of the <span class="math notranslate nohighlight">\(\Delta\)</span> log-likelihood test statistic using the asimov dataset.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">qobs</span></code>(self, poinull[, onesided, …])</p></td>
<td><p>Computes observed values of the <span class="math notranslate nohighlight">\(\Delta\)</span> log-likelihood test statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params_to_bestfit</span></code>(self)</p></td>
<td><p>Set the values of the parameters in the models to the best fit values</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.asimov_dataset">
<code class="sig-name descname">asimov_dataset</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">poi</em><span class="sig-paren">)</span> &#x2192; Tuple[numpy.ndarray, numpy.ndarray]<a class="reference internal" href="../_modules/hepstats/hypotests/calculators/asymptotic_calculator.html#AsymptoticCalculator.asimov_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.asimov_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the Asimov dataset for a given alternative hypothesis.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>poi</strong> (<cite>POI</cite>): parameter of interest of the alternative hypothesis</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>Dataset</p>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poialt</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">asimov_dataset</span><span class="p">(</span><span class="n">poialt</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.asimov_loss">
<code class="sig-name descname">asimov_loss</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">poi</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/asymptotic_calculator.html#AsymptoticCalculator.asimov_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.asimov_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a loss function using the Asimov dataset for a given alternative hypothesis.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>poi</strong> (<cite>POI</cite>): parameter of interest of the alternative hypothesis</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>Loss function</p>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poialt</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">asimov_loss</span><span class="p">(</span><span class="n">poialt</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.asimov_nll">
<code class="sig-name descname">asimov_nll</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">pois</em>, <em class="sig-param">poialt</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/hepstats/hypotests/calculators/asymptotic_calculator.html#AsymptoticCalculator.asimov_nll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.asimov_nll" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes negative log-likelihood values for given parameters of interest using the Asimov dataset
generated with a given alternative hypothesis.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>pois</strong> (<cite>POIarray</cite>): parameters of interest</p></li>
<li><p><strong>poialt</strong> (<cite>POI</cite>): parameter of interest of the alternative hypothesis</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p><cite>numpy.array</cite>: alternative nll values</p>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poinull</span> <span class="o">=</span> <span class="n">POIarray</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poialt</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nll</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">asimov_nll</span><span class="p">(</span><span class="n">poinull</span><span class="p">,</span> <span class="n">poialt</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.check_pois">
<em class="property">static </em><code class="sig-name descname">check_pois</code><span class="sig-paren">(</span><em class="sig-param">pois</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/asymptotic_calculator.html#AsymptoticCalculator.check_pois"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.check_pois" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the parameters of interest are all <cite>hepstats.parameters.POI/POIarray</cite> instances.</p>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.palt">
<code class="sig-name descname">palt</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">qobs</em>, <em class="sig-param">qalt</em>, <em class="sig-param">onesided=True</em>, <em class="sig-param">onesideddiscovery=False</em>, <em class="sig-param">qtilde=False</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/hepstats/hypotests/calculators/asymptotic_calculator.html#AsymptoticCalculator.palt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.palt" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the pvalue for the alternative hypothesis.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>qobs</strong> (<cite>np.array</cite>): observed values of the test-statistic q</p></li>
<li><p><strong>qalt</strong> (<cite>np.array</cite>): alternative values of the test-statistic q using the Asimov dataset</p></li>
<li><p><strong>onesided</strong> (bool, optional): if <cite>True</cite> (default) computes onesided pvalues</p></li>
<li><p><strong>onesideddiscovery</strong> (bool, optional): if <cite>True</cite> (default) computes onesided pvalues for a discovery</p></li>
<li><p><strong>qtilde</strong> (bool, optional): if <cite>True</cite> use the <span class="math notranslate nohighlight">\(\widetilde{q}\)</span> test statistics else (default)
use the <span class="math notranslate nohighlight">\(q\)</span> test statistic</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p><cite>numpy.array</cite> : array of the pvalues for the alternative hypothesis</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.pnull">
<code class="sig-name descname">pnull</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">qobs</em>, <em class="sig-param">qalt=None</em>, <em class="sig-param">onesided=True</em>, <em class="sig-param">onesideddiscovery=False</em>, <em class="sig-param">qtilde=False</em>, <em class="sig-param">nsigma=0</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/hepstats/hypotests/calculators/asymptotic_calculator.html#AsymptoticCalculator.pnull"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.pnull" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the pvalue for the null hypothesis.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>qobs</strong> (<cite>numpy.array</cite>): observed values of the test-statistic q</p></li>
<li><p><strong>qalt</strong> (<cite>numpy.array</cite>): alternative values of the test-statistic q using the asimov dataset</p></li>
<li><p><strong>onesided</strong> (bool, optional): if <cite>True</cite> (default) computes onesided pvalues</p></li>
<li><p><strong>onesideddiscovery</strong> (bool, optional): if <cite>True</cite> (default) computes onesided pvalues for a discovery</p></li>
<li><p><strong>qtilde</strong> (bool, optional): if <cite>True</cite> use the <span class="math notranslate nohighlight">\(\widetilde{q}\)</span> test statistics else (default)
use the <span class="math notranslate nohighlight">\(q\)</span> test statistic</p></li>
<li><p><strong>nsigma</strong> (float, optional): significance shift</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p><cite>np.array</cite> : array of the pvalues for the null hypothesis</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.qalt">
<code class="sig-name descname">qalt</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">poinull</em>, <em class="sig-param">poialt</em>, <em class="sig-param">onesided</em>, <em class="sig-param">onesideddiscovery</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/hepstats/hypotests/calculators/asymptotic_calculator.html#AsymptoticCalculator.qalt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.asymptotic_calculator.AsymptoticCalculator.qalt" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes alternative hypothesis values of the <span class="math notranslate nohighlight">\(\Delta\)</span> log-likelihood test statistic using the asimov
dataset.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>poinull</strong> (<cite>POIarray</cite>): parameters of interest for the null hypothesis</p></li>
<li><p><strong>poialt</strong> (<cite>POIarray</cite>): parameters of interest for the alternative hypothesis</p></li>
<li><p><strong>onesided</strong> (bool, optional): if <cite>True</cite> (default) computes onesided pvalues</p></li>
<li><p><strong>onesideddiscovery</strong> (bool, optional): if <cite>True</cite> (default) computes onesided pvalues for a
discovery test</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p><cite>numpy.array</cite>: observed values of q</p>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poinull</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poialt</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">qalt</span><span class="p">([</span><span class="n">poinull</span><span class="p">],</span> <span class="p">[</span><span class="n">poialt</span><span class="p">])</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="hepstats.hypotests.calculators.asymptotic_calculator.generate_asimov_hist">
<code class="sig-prename descclassname">hepstats.hypotests.calculators.asymptotic_calculator.</code><code class="sig-name descname">generate_asimov_hist</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">params</em>, <em class="sig-param">nbins=100</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/asymptotic_calculator.html#generate_asimov_hist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.asymptotic_calculator.generate_asimov_hist" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the Asimov histogram using a model and dictionary of parameters.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>model</strong> : model used to generate the dataset</p></li>
<li><p><strong>params</strong> (Dict) : values of the parameters of the models</p></li>
<li><p><strong>nbins</strong> (int, optional) : number of bins</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>(<cite>numpy.array</cite>, <cite>numpy.array</cite>) : hist, bin_edges</p>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Space</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">generate_asimov_hist</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">,</span> <span class="s2">&quot;sigma&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-hepstats.hypotests.calculators.frequentist_calculator">
<span id="frequentist"></span><h4>Frequentist<a class="headerlink" href="#module-hepstats.hypotests.calculators.frequentist_calculator" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="hepstats.hypotests.calculators.frequentist_calculator.FrequentistCalculator">
<em class="property">class </em><code class="sig-prename descclassname">hepstats.hypotests.calculators.frequentist_calculator.</code><code class="sig-name descname">FrequentistCalculator</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">minimizer</em>, <em class="sig-param">ntoysnull=100</em>, <em class="sig-param">ntoysalt=100</em>, <em class="sig-param">sampler=&lt;function base_sampler&gt;</em>, <em class="sig-param">sample=&lt;function base_sample&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/frequentist_calculator.html#FrequentistCalculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.frequentist_calculator.FrequentistCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hepstats.hypotests.calculators.basecalculator.ToysCalculator" title="hepstats.hypotests.calculators.basecalculator.ToysCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">hepstats.hypotests.calculators.basecalculator.ToysCalculator</span></code></a></p>
<p>Frequentist calculator class.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>input</strong> : loss or fit result</p></li>
<li><p><strong>minimizer</strong> : minimizer to use to find the minimum of the loss function</p></li>
<li><p><strong>ntoysnull</strong> (int, default=100): minimum number of toys to generate for the null hypothesis</p></li>
<li><p><strong>ntoysalt</strong> (int, default=100): minimum number of toys to generate for the alternative hypothesis</p></li>
<li><p><strong>sampler</strong> : function used to create sampler with models, number of events and floating parameters in the sample. Default is <cite>hepstats.fitutils.sampling.base_sampler</cite>.</p></li>
<li><p><strong>sample</strong> : function used to get samples from the sampler. Default is <cite>hepstats.fitutils.sampling.base_sample</cite>.</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">zfit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zfit.core.loss</span> <span class="kn">import</span> <span class="n">UnbinnedNLL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zfit.minimize</span> <span class="kn">import</span> <span class="n">MinuitMinimizer</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Space</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">UnbinnedNLL</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="p">[</span><span class="n">model</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">data</span><span class="p">],</span> <span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="n">obs</span><span class="p">])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">FrequentistCalculator</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">minimizer</span><span class="o">=</span><span class="n">MinuitMinimizer</span><span class="p">(),</span> <span class="n">ntoysnull</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">ntoysalt</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">bestfit</span></code></dt><dd><p>Returns the best fit values of the model parameters.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">constraints</span></code></dt><dd><p>Returns the constraints on the loss / likehood function.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></dt><dd><p>Returns the data.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">loss</span></code></dt><dd><p>Returns the loss / likelihood function.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimizer</span></code></dt><dd><p>Returns the minimizer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></dt><dd><p>Returns the model.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">ntoysalt</span></code></dt><dd><p>Returns the number of toys generated for the alternative hypothesis.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">ntoysnull</span></code></dt><dd><p>Returns the number of toys generated for the null hypothesis.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_toyresult</span></code>(self, toy)</p></td>
<td><p>Add ToyResult to the manager.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_pois</span></code>(pois)</p></td>
<td><p>Checks if the parameters of interest are all <cite>hepstats.parameters.POI/POIarray</cite> instances.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_pois_compatibility</span></code>(poi1, poi2)</p></td>
<td><p>Checks compatibility between two lists of <cite>hepstats.parameters.POIarray</cite> instances.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">expected_poi</span></code>(self, poinull, poialt, nsigma)</p></td>
<td><p>Computes the expected parameter of interest values such that the expected p_values = <span class="math notranslate nohighlight">\(lpha\)</span> for different values of <span class="math notranslate nohighlight">\(\sigma\)</span> (0=expected/median)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">expected_pvalue</span></code>(self, poinull, poialt, nsigma)</p></td>
<td><p>Computes the expected pvalues and error bands for different values of <span class="math notranslate nohighlight">\(\sigma\)</span> (0=expected/median)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_yaml</span></code>(filename, loss, minimizer[, …])</p></td>
<td><p>ToysCalculator constructor with the toys loaded from a yaml file.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_and_fit_toys</span></code>(self, ntoys, poigen, …)</p></td>
<td><p>Generate and fit toys for at a given POI (poigen).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code>(self, name)</p></td>
<td><p>Returns the parameter in loss function with given input name.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_toyresult</span></code>(self, poigen, poieval)</p></td>
<td><p>Getter function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_toys_alt</span></code>(self, poigen, poieval[, qtilde])</p></td>
<td><p>Return the generated toys for the alternative hypothesis.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_toys_null</span></code>(self, poigen, poieval[, qtilde])</p></td>
<td><p>Return the generated toys for the null hypothesis.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">keys</span></code>(self)</p></td>
<td><p>Returns keys of the <cite>ToysManager</cite> instance defined as <cite>key = (toy.poigen, toy.poieval)</cite> for a given <cite>ToyResult</cite> instance <cite>toy</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">lossbuilder</span></code>(self, model, data[, weights])</p></td>
<td><p>Method to build a new loss function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ntoys</span></code>(self, poigen, poieval)</p></td>
<td><p>Return the number of toys generated from given value of a POI, and scanned/evaluated for given values_equal of the same POI.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">obs_nll</span></code>(self, pois)</p></td>
<td><p>Compute observed negative log-likelihood values for given parameters of interest.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pvalue</span></code>(self, poinull, poialt, NoneType] = None)</p></td>
<td><p>Computes pvalues for the null and alternative hypothesis.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">q</span></code>(self, nll1, nll2, poi1, poi2[, onesided, …])</p></td>
<td><p>Compute values of the test statistic q defined as the difference between negative log-likelihood values <span class="math notranslate nohighlight">\(q = nll1 - nll2\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.frequentist_calculator.FrequentistCalculator.qalt" title="hepstats.hypotests.calculators.frequentist_calculator.FrequentistCalculator.qalt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">qalt</span></code></a>(self, poinull, poialt, onesided, …[, …])</p></td>
<td><p>Computes alternative hypothesis values of the <span class="math notranslate nohighlight">\(\Delta\)</span> log-likelihood test statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.calculators.frequentist_calculator.FrequentistCalculator.qnull" title="hepstats.hypotests.calculators.frequentist_calculator.FrequentistCalculator.qnull"><code class="xref py py-obj docutils literal notranslate"><span class="pre">qnull</span></code></a>(self, poinull, poialt, onesided, …)</p></td>
<td><p>Computes null hypothesis values of the <span class="math notranslate nohighlight">\(\Delta\)</span> log-likelihood test statistic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">qobs</span></code>(self, poinull[, onesided, …])</p></td>
<td><p>Computes observed values of the <span class="math notranslate nohighlight">\(\Delta\)</span> log-likelihood test statistic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample</span></code>(self, sampler, ntoys[, poi])</p></td>
<td><p>Returns the samples generated from the sampler for a given value of a parameter of interest</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sampler</span></code>(self[, floating_params])</p></td>
<td><p>Create sampler with models.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params_to_bestfit</span></code>(self)</p></td>
<td><p>Set the values of the parameters in the models to the best fit values</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_yaml</span></code>(self, filename)</p></td>
<td><p>Save the toys into a yaml file under the key <cite>toys</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">toyresults_to_dict</span></code>(self)</p></td>
<td><p>Returns a list of all the toy results converted into dictionnaries</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">toys_loss</span></code>(self, parameter_name)</p></td>
<td><p>Construct a loss function constructed with a sampler for a given floating parameter</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">toysresults_from_yaml</span></code>(self, filename)</p></td>
<td><p>Extract toy results from a yaml file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">values</span></code>(self)</p></td>
<td><p>Returns values of <cite>ToysManager</cite> instance that are <cite>ToyResult</cite> instances.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="hepstats.hypotests.calculators.frequentist_calculator.FrequentistCalculator.qalt">
<code class="sig-name descname">qalt</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">poinull</em>, <em class="sig-param">poialt</em>, <em class="sig-param">onesided</em>, <em class="sig-param">onesideddiscovery</em>, <em class="sig-param">qtilde=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/frequentist_calculator.html#FrequentistCalculator.qalt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.frequentist_calculator.FrequentistCalculator.qalt" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes alternative hypothesis values of the <span class="math notranslate nohighlight">\(\Delta\)</span> log-likelihood test statistic.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>poinull</strong> (<cite>POIarray</cite>): parameters of interest for the null hypothesis</p></li>
<li><p><strong>poialt</strong> (<cite>POIarray</cite>): parameters of interest for the alternative hypothesis</p></li>
<li><p><strong>onesided</strong> (bool): if <cite>True</cite> computes onesided pvalues</p></li>
<li><p><strong>onesideddiscovery</strong> (bool, optional): if <cite>True</cite> (default) computes onesided pvalues for a
discovery test</p></li>
<li><p>** qtilde** (bool): if <cite>True</cite> use the <span class="math notranslate nohighlight">\(\widetilde{q}\)</span> test statistics else use the
<span class="math notranslate nohighlight">\(q\)</span> test statistic</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p><cite>numpy.array</cite>: observed values of q</p>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poinull</span> <span class="o">=</span> <span class="n">POIarray</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poialt</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">qalt</span><span class="p">(</span><span class="n">poinull</span><span class="p">,</span> <span class="n">poialt</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.calculators.frequentist_calculator.FrequentistCalculator.qnull">
<code class="sig-name descname">qnull</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">poinull</em>, <em class="sig-param">poialt</em>, <em class="sig-param">onesided</em>, <em class="sig-param">onesideddiscovery</em>, <em class="sig-param">qtilde=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/calculators/frequentist_calculator.html#FrequentistCalculator.qnull"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.calculators.frequentist_calculator.FrequentistCalculator.qnull" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes null hypothesis values of the <span class="math notranslate nohighlight">\(\Delta\)</span> log-likelihood test statistic.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>poinull</strong> (<cite>POIarray</cite>): parameters of interest for the null hypothesis</p></li>
<li><p><strong>poialt</strong> (<cite>POIarray</cite>): parameters of interest for the alternative hypothesis</p></li>
<li><p><strong>onesided</strong> (bool): if <cite>True</cite> computes onesided pvalues</p></li>
<li><p><strong>onesideddiscovery</strong> (bool): if <cite>True</cite> computes onesided pvalues for a discovery test</p></li>
<li><p><strong>qtilde</strong> (bool): if <cite>True</cite> use the <span class="math notranslate nohighlight">\(\widetilde{q}\)</span> test statistics else use the <span class="math notranslate nohighlight">\(q\)</span> test statistic</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p><cite>numpy.array</cite>: observed values of q</p>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poinull</span> <span class="o">=</span> <span class="n">POIarray</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poialt</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">qnull</span><span class="p">(</span><span class="n">poinull</span><span class="p">,</span> <span class="n">poialt</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-hepstats.hypotests.core.discovery">
<span id="discovery-test"></span><h3>Discovery test<a class="headerlink" href="#module-hepstats.hypotests.core.discovery" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="hepstats.hypotests.core.discovery.Discovery">
<em class="property">class </em><code class="sig-prename descclassname">hepstats.hypotests.core.discovery.</code><code class="sig-name descname">Discovery</code><span class="sig-paren">(</span><em class="sig-param">calculator</em>, <em class="sig-param">poinull</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/core/discovery.html#Discovery"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.core.discovery.Discovery" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">hepstats.hypotests.core.basetest.BaseTest</span></code></p>
<p>Class for discovery test.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>calculator</strong> (<cite>sktats.hypotests.BaseCalculator</cite>): calculator to use for computing the pvalues</p></li>
<li><p><strong>poinull</strong> (<cite>POI</cite>): parameter of interest for the null hypothesis</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">zfit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zfit.loss</span> <span class="kn">import</span> <span class="n">ExtendedUnbinnedNLL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zfit.minimize</span> <span class="kn">import</span> <span class="n">Minuit</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zfit</span><span class="o">.</span><span class="n">Space</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bkg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">bkg</span><span class="p">,</span> <span class="n">peak</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span> <span class="o">&lt;</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lambda_</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;lambda&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Nsig</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;Ns&quot;</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Nbkg</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;Nbkg&quot;</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">N</span><span class="o">*</span><span class="mf">1.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">Nsig</span> <span class="o">*</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">background</span> <span class="o">=</span> <span class="n">Nbkg</span> <span class="o">*</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="n">lambda_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">ExtendedUnbinnedNLL</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">signal</span> <span class="o">+</span> <span class="n">background</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hepstats.hypotests.calculators</span> <span class="kn">import</span> <span class="n">AsymptoticCalculator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hepstats.hypotests</span> <span class="kn">import</span> <span class="n">Discovery</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hepstats.hypotests.parameters</span> <span class="kn">import</span> <span class="n">POI</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calculator</span> <span class="o">=</span> <span class="n">AsymptoticCalculator</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">Minuit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poinull</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">Nsig</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">discovery_test</span> <span class="o">=</span> <span class="n">Discovery</span><span class="p">(</span><span class="n">calculator</span><span class="p">,</span> <span class="n">poinull</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">discovery_test</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="go">p_value for the Null hypothesis = 0.0007571045424956679</span>
<span class="go">Significance (in units of sigma) = 3.1719464825102244</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculator</span></code></dt><dd><p>Returns the calculator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">poialt</span></code></dt><dd><p>Returns the POI for the alternative hypothesis.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">poinull</span></code></dt><dd><p>Returns the POI for the null hypothesis.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.core.discovery.Discovery.result" title="hepstats.hypotests.core.discovery.Discovery.result"><code class="xref py py-obj docutils literal notranslate"><span class="pre">result</span></code></a>(self[, printlevel])</p></td>
<td><p>Returns the result of the discovery hypothesis test.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="hepstats.hypotests.core.discovery.Discovery.result">
<code class="sig-name descname">result</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">printlevel=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/core/discovery.html#Discovery.result"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.core.discovery.Discovery.result" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the result of the discovery hypothesis test.</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>printlevel</strong> (int, default=1): if &gt; 0 print the result</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>Tuple(float, float): pnull, significance</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-hepstats.hypotests.core.upperlimit">
<span id="upper-limit"></span><h3>Upper limit<a class="headerlink" href="#module-hepstats.hypotests.core.upperlimit" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="hepstats.hypotests.core.upperlimit.UpperLimit">
<em class="property">class </em><code class="sig-prename descclassname">hepstats.hypotests.core.upperlimit.</code><code class="sig-name descname">UpperLimit</code><span class="sig-paren">(</span><em class="sig-param">calculator</em>, <em class="sig-param">poinull</em>, <em class="sig-param">poialt</em>, <em class="sig-param">qtilde=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/core/upperlimit.html#UpperLimit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.core.upperlimit.UpperLimit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">hepstats.hypotests.core.basetest.BaseTest</span></code></p>
<p>Class for upper limit calculation.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>calculator</strong> (<cite>sktats.hypotests.BaseCalculator</cite>): calculator to use for computing the pvalues</p></li>
<li><p><strong>poinull</strong> (List[<cite>hypotests.POI</cite>]): parameters of interest for the null hypothesis</p></li>
<li><p><strong>poialt</strong> (List[<cite>hypotests.POI</cite>]): parameters of interest for the alternative hypothesis</p></li>
<li><p><strong>qtilde</strong> (bool, optional): if <cite>True</cite> use the <span class="math notranslate nohighlight">\(\widetilde{q}\)</span> test statistics else (default) use the <span class="math notranslate nohighlight">\(q\)</span> test statistic</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">zfit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zfit.loss</span> <span class="kn">import</span> <span class="n">ExtendedUnbinnedNLL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zfit.minimize</span> <span class="kn">import</span> <span class="n">Minuit</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zfit</span><span class="o">.</span><span class="n">Space</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bkg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">bkg</span><span class="p">,</span> <span class="n">peak</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span> <span class="o">&lt;</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lambda_</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;lambda&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Nsig</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;Ns&quot;</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Nbkg</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;Nbkg&quot;</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">N</span><span class="o">*</span><span class="mf">1.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">Nsig</span> <span class="o">*</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">background</span> <span class="o">=</span> <span class="n">Nbkg</span> <span class="o">*</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="n">lambda_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">ExtendedUnbinnedNLL</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">signal</span> <span class="o">+</span> <span class="n">background</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hepstats.hypotests.calculators</span> <span class="kn">import</span> <span class="n">AsymptoticCalculator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hepstats.hypotests</span> <span class="kn">import</span> <span class="n">UpperLimit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hepstats.hypotests.parameters</span> <span class="kn">import</span> <span class="n">POI</span><span class="p">,</span> <span class="n">POIarray</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calculator</span> <span class="o">=</span> <span class="n">AsymptoticCalculator</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">Minuit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poinull</span> <span class="o">=</span> <span class="n">POIarray</span><span class="p">(</span><span class="n">Nsig</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poialt</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">Nsig</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ul</span> <span class="o">=</span> <span class="n">UpperLimit</span><span class="p">(</span><span class="n">calculator</span><span class="p">,</span> <span class="n">poinull</span><span class="p">,</span> <span class="n">poialt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ul</span><span class="o">.</span><span class="n">upperlimit</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">CLs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Observed upper limit: Nsig = 15.725784747406346</span>
<span class="go">Expected upper limit: Nsig = 11.927442041887158</span>
<span class="go">Expected upper limit +1 sigma: Nsig = 16.596396280677116</span>
<span class="go">Expected upper limit -1 sigma: Nsig = 8.592750403611896</span>
<span class="go">Expected upper limit +2 sigma: Nsig = 22.24864429383046</span>
<span class="go">Expected upper limit -2 sigma: Nsig = 6.400549971360598</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculator</span></code></dt><dd><p>Returns the calculator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">poialt</span></code></dt><dd><p>Returns the POI for the alternative hypothesis.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">poinull</span></code></dt><dd><p>Returns the POI for the null hypothesis.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.core.upperlimit.UpperLimit.qtilde" title="hepstats.hypotests.core.upperlimit.UpperLimit.qtilde"><code class="xref py py-obj docutils literal notranslate"><span class="pre">qtilde</span></code></a></dt><dd><p>Returns True if qtilde test statistic is used, else False.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.core.upperlimit.UpperLimit.pvalues" title="hepstats.hypotests.core.upperlimit.UpperLimit.pvalues"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pvalues</span></code></a>(self[, CLs])</p></td>
<td><p>Returns p-values scanned for the values of the parameters of interest in the null hypothesis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.core.upperlimit.UpperLimit.upperlimit" title="hepstats.hypotests.core.upperlimit.UpperLimit.upperlimit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">upperlimit</span></code></a>(self[, alpha, CLs, printlevel])</p></td>
<td><p>Returns the upper limit of the parameter of interest.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="hepstats.hypotests.core.upperlimit.UpperLimit.pvalues">
<code class="sig-name descname">pvalues</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">CLs=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/core/upperlimit.html#UpperLimit.pvalues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.core.upperlimit.UpperLimit.pvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns p-values scanned for the values of the parameters of interest
in the null hypothesis.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>CLs</strong> (bool, optional): if <cite>True</cite> uses pvalues as <span class="math notranslate nohighlight">\(p_{cls}=p_{null}/p_{alt}=p_{clsb}/p_{clb}\)</span> else as <span class="math notranslate nohighlight">\(p_{clsb} = p_{null}\)</span></p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>pvalues (Dict): CLsb, CLs, expected (+/- sigma bands) p-values</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.core.upperlimit.UpperLimit.qtilde">
<em class="property">property </em><code class="sig-name descname">qtilde</code><a class="headerlink" href="#hepstats.hypotests.core.upperlimit.UpperLimit.qtilde" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if qtilde test statistic is used, else False.</p>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.core.upperlimit.UpperLimit.upperlimit">
<code class="sig-name descname">upperlimit</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">alpha=0.05</em>, <em class="sig-param">CLs=True</em>, <em class="sig-param">printlevel=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/core/upperlimit.html#UpperLimit.upperlimit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.core.upperlimit.UpperLimit.upperlimit" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the upper limit of the parameter of interest.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>alpha</strong> (float, default=0.05): significance level</p></li>
<li><p><strong>CLs</strong> (bool, optional): if <cite>True</cite> uses pvalues as <span class="math notranslate nohighlight">\(p_{cls}=p_{null}/p_{alt}=p_{clsb}/p_{clb}\)</span> else as <span class="math notranslate nohighlight">\(p_{clsb} = p_{null}\)</span></p></li>
<li><p><strong>printlevel</strong> (int, default=1): if &gt; 0 print the result</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>limits (Dict): observed, expected (+/- sigma bands) upper limits</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-hepstats.hypotests.core.confidence_interval">
<span id="confidence-interval"></span><h3>Confidence interval<a class="headerlink" href="#module-hepstats.hypotests.core.confidence_interval" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="hepstats.hypotests.core.confidence_interval.ConfidenceInterval">
<em class="property">class </em><code class="sig-prename descclassname">hepstats.hypotests.core.confidence_interval.</code><code class="sig-name descname">ConfidenceInterval</code><span class="sig-paren">(</span><em class="sig-param">calculator</em>, <em class="sig-param">poinull</em>, <em class="sig-param">qtilde=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/core/confidence_interval.html#ConfidenceInterval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.core.confidence_interval.ConfidenceInterval" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">hepstats.hypotests.core.basetest.BaseTest</span></code></p>
<p>Class for confidence interval calculation.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>calculator</strong> (<cite>sktats.hypotests.BaseCalculator</cite>): calculator to use for computing the pvalues</p></li>
<li><p><strong>poinull</strong> (<cite>POIarray</cite>): parameters of interest for the null hypothesis</p></li>
<li><p><strong>qtilde</strong> (bool, optional): if <cite>True</cite> use the <span class="math notranslate nohighlight">\(\widetilde{q}\)</span> test statistics else (default) use the <span class="math notranslate nohighlight">\(q\)</span> test statistic</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">zfit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zfit.loss</span> <span class="kn">import</span> <span class="n">ExtendedUnbinnedNLL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zfit.minimize</span> <span class="kn">import</span> <span class="n">Minuit</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zfit</span><span class="o">.</span><span class="n">Space</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bkg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">bkg</span><span class="p">,</span> <span class="n">peak</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span> <span class="o">&lt;</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lambda_</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;lambda&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Nsig</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;Ns&quot;</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Nbkg</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;Nbkg&quot;</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">N</span><span class="o">*</span><span class="mf">1.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">Nsig</span> <span class="o">*</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">background</span> <span class="o">=</span> <span class="n">Nbkg</span> <span class="o">*</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="n">lambda_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">ExtendedUnbinnedNLL</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">signal</span> <span class="o">+</span> <span class="n">background</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hepstats.hypotests.calculators</span> <span class="kn">import</span> <span class="n">AsymptoticCalculator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hepstats.hypotests</span> <span class="kn">import</span> <span class="n">ConfidenceInterval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hepstats.hypotests.parameters</span> <span class="kn">import</span> <span class="n">POI</span><span class="p">,</span> <span class="n">POIarray</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calculator</span> <span class="o">=</span> <span class="n">AsymptoticCalculator</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">Minuit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poinull</span> <span class="o">=</span> <span class="n">POIarray</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.15</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ci</span> <span class="o">=</span> <span class="n">ConfidenceInterval</span><span class="p">(</span><span class="n">calculator</span><span class="p">,</span> <span class="n">poinull</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ci</span><span class="o">.</span><span class="n">interval</span><span class="p">()</span>
<span class="go">Confidence interval on mean:</span>
<span class="go">    1.1810371356602791 &lt; mean &lt; 1.2156701172321935 at 68.0% C.L.</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculator</span></code></dt><dd><p>Returns the calculator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">poialt</span></code></dt><dd><p>Returns the POI for the alternative hypothesis.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">poinull</span></code></dt><dd><p>Returns the POI for the null hypothesis.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.core.confidence_interval.ConfidenceInterval.qtilde" title="hepstats.hypotests.core.confidence_interval.ConfidenceInterval.qtilde"><code class="xref py py-obj docutils literal notranslate"><span class="pre">qtilde</span></code></a></dt><dd><p>Returns True if qtilde test statistic is used, else False.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.core.confidence_interval.ConfidenceInterval.interval" title="hepstats.hypotests.core.confidence_interval.ConfidenceInterval.interval"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interval</span></code></a>(self[, alpha, printlevel])</p></td>
<td><p>Returns the confidence level on the parameter of interest.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.core.confidence_interval.ConfidenceInterval.pvalues" title="hepstats.hypotests.core.confidence_interval.ConfidenceInterval.pvalues"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pvalues</span></code></a>(self)</p></td>
<td><p>Returns p-values scanned for the values of the parameters of interest in the null hypothesis.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="hepstats.hypotests.core.confidence_interval.ConfidenceInterval.interval">
<code class="sig-name descname">interval</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">alpha=0.32</em>, <em class="sig-param">printlevel=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/core/confidence_interval.html#ConfidenceInterval.interval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.core.confidence_interval.ConfidenceInterval.interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the confidence level on the parameter of interest.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>alpha</strong> (float, default=0.32/1 sigma): significance level,</p></li>
<li><p><strong>printlevel</strong> (int, default=1): if &gt; 0 print the result</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>limits (Dict): central, upper and lower bounds on the parameter of interest</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.core.confidence_interval.ConfidenceInterval.pvalues">
<code class="sig-name descname">pvalues</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/core/confidence_interval.html#ConfidenceInterval.pvalues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.core.confidence_interval.ConfidenceInterval.pvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns p-values scanned for the values of the parameters of interest
in the null hypothesis.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>pvalues (<cite>np.array</cite>): CLsb, CLs, expected (+/- sigma bands) p-values</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.core.confidence_interval.ConfidenceInterval.qtilde">
<em class="property">property </em><code class="sig-name descname">qtilde</code><a class="headerlink" href="#hepstats.hypotests.core.confidence_interval.ConfidenceInterval.qtilde" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if qtilde test statistic is used, else False.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-hepstats.hypotests.hypotests_object">
<span id="hypotests-objects"></span><h3>Hypotests objects<a class="headerlink" href="#module-hepstats.hypotests.hypotests_object" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="hepstats.hypotests.hypotests_object.HypotestsObject">
<em class="property">class </em><code class="sig-prename descclassname">hepstats.hypotests.hypotests_object.</code><code class="sig-name descname">HypotestsObject</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">minimizer</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#HypotestsObject"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.hypotests_object.HypotestsObject" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base object in <cite>hepstats.hypotests</cite> to manipulate a loss function and a minimizer.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>input</strong> : loss or fit result</p></li>
<li><p><strong>minimizer</strong> : minimizer to use to find the minimum of the loss function</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.bestfit" title="hepstats.hypotests.hypotests_object.HypotestsObject.bestfit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bestfit</span></code></a></dt><dd><p>Returns the best fit values of the model parameters.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.constraints" title="hepstats.hypotests.hypotests_object.HypotestsObject.constraints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">constraints</span></code></a></dt><dd><p>Returns the constraints on the loss / likehood function.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.data" title="hepstats.hypotests.hypotests_object.HypotestsObject.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></a></dt><dd><p>Returns the data.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.loss" title="hepstats.hypotests.hypotests_object.HypotestsObject.loss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">loss</span></code></a></dt><dd><p>Returns the loss / likelihood function.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.minimizer" title="hepstats.hypotests.hypotests_object.HypotestsObject.minimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimizer</span></code></a></dt><dd><p>Returns the minimizer.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.model" title="hepstats.hypotests.hypotests_object.HypotestsObject.model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></a></dt><dd><p>Returns the model.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.get_parameter" title="hepstats.hypotests.hypotests_object.HypotestsObject.get_parameter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code></a>(self, name)</p></td>
<td><p>Returns the parameter in loss function with given input name.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.lossbuilder" title="hepstats.hypotests.hypotests_object.HypotestsObject.lossbuilder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lossbuilder</span></code></a>(self, model, data[, weights])</p></td>
<td><p>Method to build a new loss function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.set_params_to_bestfit" title="hepstats.hypotests.hypotests_object.HypotestsObject.set_params_to_bestfit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params_to_bestfit</span></code></a>(self)</p></td>
<td><p>Set the values of the parameters in the models to the best fit values</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="hepstats.hypotests.hypotests_object.HypotestsObject.bestfit">
<em class="property">property </em><code class="sig-name descname">bestfit</code><a class="headerlink" href="#hepstats.hypotests.hypotests_object.HypotestsObject.bestfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the best fit values of the model parameters.</p>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.hypotests_object.HypotestsObject.constraints">
<em class="property">property </em><code class="sig-name descname">constraints</code><a class="headerlink" href="#hepstats.hypotests.hypotests_object.HypotestsObject.constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the constraints on the loss / likehood function.</p>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.hypotests_object.HypotestsObject.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#hepstats.hypotests.hypotests_object.HypotestsObject.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the data.</p>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.hypotests_object.HypotestsObject.get_parameter">
<code class="sig-name descname">get_parameter</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#HypotestsObject.get_parameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.hypotests_object.HypotestsObject.get_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the parameter in loss function with given input name.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>name (str): name of the parameter to return</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.hypotests_object.HypotestsObject.loss">
<em class="property">property </em><code class="sig-name descname">loss</code><a class="headerlink" href="#hepstats.hypotests.hypotests_object.HypotestsObject.loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the loss / likelihood function.</p>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.hypotests_object.HypotestsObject.lossbuilder">
<code class="sig-name descname">lossbuilder</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">model</em>, <em class="sig-param">data</em>, <em class="sig-param">weights=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#HypotestsObject.lossbuilder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.hypotests_object.HypotestsObject.lossbuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to build a new loss function.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>model</strong> (List): The model or models to evaluate the data on</p></li>
<li><p><strong>data</strong> (List): Data to use</p></li>
<li><p><strong>weights</strong> (optional, List): the data weights</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">lossbuilder</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt><dd><p>Loss function</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.hypotests_object.HypotestsObject.minimizer">
<em class="property">property </em><code class="sig-name descname">minimizer</code><a class="headerlink" href="#hepstats.hypotests.hypotests_object.HypotestsObject.minimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the minimizer.</p>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.hypotests_object.HypotestsObject.model">
<em class="property">property </em><code class="sig-name descname">model</code><a class="headerlink" href="#hepstats.hypotests.hypotests_object.HypotestsObject.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the model.</p>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.hypotests_object.HypotestsObject.set_params_to_bestfit">
<code class="sig-name descname">set_params_to_bestfit</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#HypotestsObject.set_params_to_bestfit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.hypotests_object.HypotestsObject.set_params_to_bestfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the values of the parameters in the models to the best fit values</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="hepstats.hypotests.hypotests_object.ToysObject">
<em class="property">class </em><code class="sig-prename descclassname">hepstats.hypotests.hypotests_object.</code><code class="sig-name descname">ToysObject</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">minimizer</em>, <em class="sig-param">sampler</em>, <em class="sig-param">sample</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#ToysObject"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.hypotests_object.ToysObject" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject" title="hepstats.hypotests.hypotests_object.HypotestsObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">hepstats.hypotests.hypotests_object.HypotestsObject</span></code></a></p>
<p>Base object in <cite>hepstats.hypotests</cite> to manipulate a loss function, a minimizer and sample a
model (within the loss function) to do toy experiments.</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>input</strong> : loss or fit result</p></li>
<li><p><strong>minimizer</strong> : minimizer to use to find the minimum of the loss function</p></li>
<li><p><strong>sampler</strong> : function used to create sampler with models, number of events and floating parameters in the sample.</p></li>
<li><p><strong>sample</strong> : function used to get samples from the sampler.</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">bestfit</span></code></dt><dd><p>Returns the best fit values of the model parameters.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">constraints</span></code></dt><dd><p>Returns the constraints on the loss / likehood function.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></dt><dd><p>Returns the data.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">loss</span></code></dt><dd><p>Returns the loss / likelihood function.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimizer</span></code></dt><dd><p>Returns the minimizer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></dt><dd><p>Returns the model.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code>(self, name)</p></td>
<td><p>Returns the parameter in loss function with given input name.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">lossbuilder</span></code>(self, model, data[, weights])</p></td>
<td><p>Method to build a new loss function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.hypotests_object.ToysObject.sample" title="hepstats.hypotests.hypotests_object.ToysObject.sample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample</span></code></a>(self, sampler, ntoys[, poi])</p></td>
<td><p>Returns the samples generated from the sampler for a given value of a parameter of interest</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.hypotests_object.ToysObject.sampler" title="hepstats.hypotests.hypotests_object.ToysObject.sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sampler</span></code></a>(self[, floating_params])</p></td>
<td><p>Create sampler with models.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params_to_bestfit</span></code>(self)</p></td>
<td><p>Set the values of the parameters in the models to the best fit values</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.hypotests_object.ToysObject.toys_loss" title="hepstats.hypotests.hypotests_object.ToysObject.toys_loss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">toys_loss</span></code></a>(self, parameter_name)</p></td>
<td><p>Construct a loss function constructed with a sampler for a given floating parameter</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="hepstats.hypotests.hypotests_object.ToysObject.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">sampler</em>, <em class="sig-param">ntoys</em>, <em class="sig-param">poi=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#ToysObject.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.hypotests_object.ToysObject.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the samples generated from the sampler for a given value of a parameter of interest</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>sampler</strong> (list): generator of samples</p></li>
<li><p><strong>ntoys</strong> (int): number of samples to generate</p></li>
<li><p><strong>poi</strong> (POI, optional):  in the sampler</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sampler</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">sampler</span><span class="p">(</span><span class="n">floating_params</span><span class="o">=</span><span class="p">[</span><span class="n">mean</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.hypotests_object.ToysObject.sampler">
<code class="sig-name descname">sampler</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">floating_params=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#ToysObject.sampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.hypotests_object.ToysObject.sampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Create sampler with models.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>floating_params</strong> (list): floating parameters in the sampler</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sampler</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">sampler</span><span class="p">(</span><span class="n">floating_params</span><span class="o">=</span><span class="p">[</span><span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">)])</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="hepstats.hypotests.hypotests_object.ToysObject.toys_loss">
<code class="sig-name descname">toys_loss</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">parameter_name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#ToysObject.toys_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.hypotests.hypotests_object.ToysObject.toys_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a loss function constructed with a sampler for a given floating parameter</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>parameter_name</strong>: name floating parameter in the sampler</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>Loss function</p>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">toys_loss</span><span class="p">(</span><span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-hepstats.hypotests.hypotests_object">
<span id="toy-utilities"></span><h3>Toy utilities<a class="headerlink" href="#module-hepstats.hypotests.hypotests_object" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">hepstats.hypotests.hypotests_object.</code><code class="sig-name descname">HypotestsObject</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">minimizer</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#HypotestsObject"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base object in <cite>hepstats.hypotests</cite> to manipulate a loss function and a minimizer.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>input</strong> : loss or fit result</p></li>
<li><p><strong>minimizer</strong> : minimizer to use to find the minimum of the loss function</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.bestfit" title="hepstats.hypotests.hypotests_object.HypotestsObject.bestfit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bestfit</span></code></a></dt><dd><p>Returns the best fit values of the model parameters.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.constraints" title="hepstats.hypotests.hypotests_object.HypotestsObject.constraints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">constraints</span></code></a></dt><dd><p>Returns the constraints on the loss / likehood function.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.data" title="hepstats.hypotests.hypotests_object.HypotestsObject.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></a></dt><dd><p>Returns the data.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.loss" title="hepstats.hypotests.hypotests_object.HypotestsObject.loss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">loss</span></code></a></dt><dd><p>Returns the loss / likelihood function.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.minimizer" title="hepstats.hypotests.hypotests_object.HypotestsObject.minimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimizer</span></code></a></dt><dd><p>Returns the minimizer.</p>
</dd>
<dt><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.model" title="hepstats.hypotests.hypotests_object.HypotestsObject.model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></a></dt><dd><p>Returns the model.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.get_parameter" title="hepstats.hypotests.hypotests_object.HypotestsObject.get_parameter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code></a>(self, name)</p></td>
<td><p>Returns the parameter in loss function with given input name.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.lossbuilder" title="hepstats.hypotests.hypotests_object.HypotestsObject.lossbuilder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lossbuilder</span></code></a>(self, model, data[, weights])</p></td>
<td><p>Method to build a new loss function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject.set_params_to_bestfit" title="hepstats.hypotests.hypotests_object.HypotestsObject.set_params_to_bestfit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params_to_bestfit</span></code></a>(self)</p></td>
<td><p>Set the values of the parameters in the models to the best fit values</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt>
<em class="property">property </em><code class="sig-name descname">bestfit</code></dt>
<dd><p>Returns the best fit values of the model parameters.</p>
</dd></dl>

<dl class="method">
<dt>
<em class="property">property </em><code class="sig-name descname">constraints</code></dt>
<dd><p>Returns the constraints on the loss / likehood function.</p>
</dd></dl>

<dl class="method">
<dt>
<em class="property">property </em><code class="sig-name descname">data</code></dt>
<dd><p>Returns the data.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">get_parameter</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#HypotestsObject.get_parameter"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns the parameter in loss function with given input name.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>name (str): name of the parameter to return</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<em class="property">property </em><code class="sig-name descname">loss</code></dt>
<dd><p>Returns the loss / likelihood function.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">lossbuilder</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">model</em>, <em class="sig-param">data</em>, <em class="sig-param">weights=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#HypotestsObject.lossbuilder"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Method to build a new loss function.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>model</strong> (List): The model or models to evaluate the data on</p></li>
<li><p><strong>data</strong> (List): Data to use</p></li>
<li><p><strong>weights</strong> (optional, List): the data weights</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">lossbuilder</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt><dd><p>Loss function</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<em class="property">property </em><code class="sig-name descname">minimizer</code></dt>
<dd><p>Returns the minimizer.</p>
</dd></dl>

<dl class="method">
<dt>
<em class="property">property </em><code class="sig-name descname">model</code></dt>
<dd><p>Returns the model.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">set_params_to_bestfit</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#HypotestsObject.set_params_to_bestfit"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Set the values of the parameters in the models to the best fit values</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">hepstats.hypotests.hypotests_object.</code><code class="sig-name descname">ToysObject</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">minimizer</em>, <em class="sig-param">sampler</em>, <em class="sig-param">sample</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#ToysObject"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#hepstats.hypotests.hypotests_object.HypotestsObject" title="hepstats.hypotests.hypotests_object.HypotestsObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">hepstats.hypotests.hypotests_object.HypotestsObject</span></code></a></p>
<p>Base object in <cite>hepstats.hypotests</cite> to manipulate a loss function, a minimizer and sample a
model (within the loss function) to do toy experiments.</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>input</strong> : loss or fit result</p></li>
<li><p><strong>minimizer</strong> : minimizer to use to find the minimum of the loss function</p></li>
<li><p><strong>sampler</strong> : function used to create sampler with models, number of events and floating parameters in the sample.</p></li>
<li><p><strong>sample</strong> : function used to get samples from the sampler.</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">bestfit</span></code></dt><dd><p>Returns the best fit values of the model parameters.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">constraints</span></code></dt><dd><p>Returns the constraints on the loss / likehood function.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></dt><dd><p>Returns the data.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">loss</span></code></dt><dd><p>Returns the loss / likelihood function.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimizer</span></code></dt><dd><p>Returns the minimizer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></dt><dd><p>Returns the model.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code>(self, name)</p></td>
<td><p>Returns the parameter in loss function with given input name.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">lossbuilder</span></code>(self, model, data[, weights])</p></td>
<td><p>Method to build a new loss function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hepstats.hypotests.hypotests_object.ToysObject.sample" title="hepstats.hypotests.hypotests_object.ToysObject.sample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample</span></code></a>(self, sampler, ntoys[, poi])</p></td>
<td><p>Returns the samples generated from the sampler for a given value of a parameter of interest</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.hypotests_object.ToysObject.sampler" title="hepstats.hypotests.hypotests_object.ToysObject.sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sampler</span></code></a>(self[, floating_params])</p></td>
<td><p>Create sampler with models.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params_to_bestfit</span></code>(self)</p></td>
<td><p>Set the values of the parameters in the models to the best fit values</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hepstats.hypotests.hypotests_object.ToysObject.toys_loss" title="hepstats.hypotests.hypotests_object.ToysObject.toys_loss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">toys_loss</span></code></a>(self, parameter_name)</p></td>
<td><p>Construct a loss function constructed with a sampler for a given floating parameter</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt>
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">sampler</em>, <em class="sig-param">ntoys</em>, <em class="sig-param">poi=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#ToysObject.sample"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns the samples generated from the sampler for a given value of a parameter of interest</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>sampler</strong> (list): generator of samples</p></li>
<li><p><strong>ntoys</strong> (int): number of samples to generate</p></li>
<li><p><strong>poi</strong> (POI, optional):  in the sampler</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sampler</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">sampler</span><span class="p">(</span><span class="n">floating_params</span><span class="o">=</span><span class="p">[</span><span class="n">mean</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">POI</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">sampler</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">floating_params=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#ToysObject.sampler"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create sampler with models.</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>floating_params</strong> (list): floating parameters in the sampler</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sampler</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">sampler</span><span class="p">(</span><span class="n">floating_params</span><span class="o">=</span><span class="p">[</span><span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">)])</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">toys_loss</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">parameter_name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/hypotests/hypotests_object.html#ToysObject.toys_loss"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Construct a loss function constructed with a sampler for a given floating parameter</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>parameter_name</strong>: name floating parameter in the sampler</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>Loss function</p>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">toys_loss</span><span class="p">(</span><span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-hepstats.splot">
<span id="hepstats-splot-module"></span><h2>hepstats.splot module<a class="headerlink" href="#module-hepstats.splot" title="Permalink to this headline">¶</a></h2>
<p>Module implementing the <strong>sPlot</strong> algorithm, see <a class="bibtex reference internal" href="../index.html#pivk-2004ty" id="id8">[PLD05]</a>.</p>
<div class="section" id="module-hepstats.splot.sweights">
<span id="sweights"></span><h3>sWeights<a class="headerlink" href="#module-hepstats.splot.sweights" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="hepstats.splot.sweights.compute_sweights">
<code class="sig-prename descclassname">hepstats.splot.sweights.</code><code class="sig-name descname">compute_sweights</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/splot/sweights.html#compute_sweights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.splot.sweights.compute_sweights" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes sWeights from probability density functions for different components/species in a fit model
(for instance signal and background) fitted on some data <cite>x</cite>.</p>
<blockquote>
<div><p>i.e. model = Nsig * pdf_signal + Nbkg * pdf_bkg</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p><strong>model</strong>: sum of extended pdfs.</p></li>
<li><p><strong>x</strong> (<cite>np.array</cite>): data on which <cite>model</cite> is fitted</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p><cite>dict(`yield</cite>, <cite>np.array</cite>)`: dictionary with yield parameters as keys, and sWeights for
correspoind species as values.</p></li>
</ul>
</dd>
<dt>Example with <cite>zfit</cite>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">zfit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zfit.loss</span> <span class="kn">import</span> <span class="n">ExtendedUnbinnedNLL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zfit.minimize</span> <span class="kn">import</span> <span class="n">Minuit</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nbkg</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsig</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zfit</span><span class="o">.</span><span class="n">Space</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bkg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">nbkg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">nsig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">bkg</span><span class="p">,</span> <span class="n">peak</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span> <span class="o">&lt;</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lambda_</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;lambda&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Nsig</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;Nsig&quot;</span><span class="p">,</span> <span class="n">nsig</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Nbkg</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;Nbkg&quot;</span><span class="p">,</span> <span class="n">nbkg</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">Nsig</span> <span class="o">*</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">background</span> <span class="o">=</span> <span class="n">Nbkg</span> <span class="o">*</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="n">lambda_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">ExtendedUnbinnedNLL</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">signal</span> <span class="o">+</span> <span class="n">background</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">minimizer</span> <span class="o">=</span> <span class="n">Minuit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">minimum</span> <span class="o">=</span> <span class="n">minimizer</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hepstats.splot</span> <span class="kn">import</span> <span class="n">compute_sweights</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sweights</span> <span class="o">=</span> <span class="n">compute_sweights</span><span class="p">(</span><span class="n">tot_model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="hepstats.splot.sweights.is_sum_of_extended_pdfs">
<code class="sig-prename descclassname">hepstats.splot.sweights.</code><code class="sig-name descname">is_sum_of_extended_pdfs</code><span class="sig-paren">(</span><em class="sig-param">model</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hepstats/splot/sweights.html#is_sum_of_extended_pdfs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hepstats.splot.sweights.is_sum_of_extended_pdfs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>
</div>


           </div>

          </div>
          <footer>

    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">


        <a href="modules.html" class="btn btn-neutral float-left" title="hepstats" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>

    </div>


  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Matthieu Marinangeli

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>






</body>
</html>
